{
    "category": "List Comprehensions",
    "description": "Comprehensive tests for list comprehension syntax",
    "tests": [
        {
            "id": "comp_basic_001",
            "input": "{x for x in 1..5}",
            "expected": [
                1,
                2,
                3,
                4,
                5
            ],
            "expectedType": "NodeVector",
            "notes": "Basic comprehension"
        },
        {
            "id": "comp_basic_002",
            "input": "{x^2 for x in 1..5}",
            "expected": [
                1,
                4,
                9,
                16,
                25
            ],
            "expectedType": "NodeVector",
            "notes": "Squares comprehension"
        },
        {
            "id": "comp_basic_003",
            "input": "{2*x for x in 1..5}",
            "expected": [
                2,
                4,
                6,
                8,
                10
            ],
            "expectedType": "NodeVector",
            "notes": "Doubled values"
        },
        {
            "id": "comp_filter_001",
            "input": "{x for x in 1..10 if x > 5}",
            "expected": [
                6,
                7,
                8,
                9,
                10
            ],
            "expectedType": "NodeVector",
            "notes": "Comprehension with filter"
        },
        {
            "id": "comp_filter_002",
            "input": "{x for x in 1..10 if x mod 2 == 0}",
            "expected": [
                2,
                4,
                6,
                8,
                10
            ],
            "expectedType": "NodeVector",
            "notes": "Even numbers comprehension"
        },
        {
            "id": "comp_filter_003",
            "input": "{x^2 for x in 1..10 if x mod 2 != 0}",
            "expected": [
                1,
                9,
                25,
                49,
                81
            ],
            "expectedType": "NodeVector",
            "notes": "Squares of odd numbers"
        },
        {
            "id": "comp_expr_001",
            "input": "{x + 10 for x in {1, 2, 3}}",
            "expected": [
                11,
                12,
                13
            ],
            "expectedType": "NodeVector",
            "notes": "Comprehension over vector"
        },
        {
            "id": "comp_expr_002",
            "input": "{sqrt(x) for x in {1, 4, 9, 16}}",
            "expected": [
                1,
                2,
                3,
                4
            ],
            "expectedType": "NodeVector",
            "notes": "Function in comprehension"
        },
        {
            "id": "comp_nested_001",
            "input": "{{x, y} for x in 1..2 for y in 1..2}",
            "expected": "{{1, 1}, {1, 2}, {2, 1}, {2, 2}}",
            "expectedType": "NodeVector",
            "notes": "Nested comprehension (cartesian product)"
        },
        {
            "id": "comp_nested_002",
            "input": "{x + y for x in 1..3 for y in 1..3}",
            "expected": [
                2,
                3,
                4,
                3,
                4,
                5,
                4,
                5,
                6
            ],
            "expectedType": "NodeVector",
            "notes": "Sums from nested iteration"
        },
        {
            "id": "comp_nested_filter_001",
            "input": "{{x, y} for x in 1..3 for y in 1..3 if x < y}",
            "expected": "{{1, 2}, {1, 3}, {2, 3}}",
            "expectedType": "NodeVector",
            "notes": "Nested with filter"
        },
        {
            "id": "comp_variable_001",
            "input": "v := 1..5; {x^2 for x in v}",
            "expected": [
                1,
                4,
                9,
                16,
                25
            ],
            "expectedType": "NodeVector",
            "notes": "Iterate over variable"
        },
        {
            "id": "comp_sum_001",
            "input": "sum({x^2 for x in 1..5})",
            "expected": 55,
            "expectedType": "NodeRational",
            "notes": "Sum of comprehension"
        },
        {
            "id": "comp_length_001",
            "input": "length({x for x in 1..10 if isprime(x)})",
            "expected": 4,
            "expectedType": "NodeRational",
            "notes": "Count primes in 1..10"
        },
        {
            "id": "comp_transform_001",
            "input": "{abs(x) for x in {-3, -2, -1, 0, 1, 2, 3}}",
            "expected": [
                3,
                2,
                1,
                0,
                1,
                2,
                3
            ],
            "expectedType": "NodeVector",
            "notes": "Absolute values"
        },
        {
            "id": "comp_conditional_001",
            "input": "{if(x mod 2 == 0, x/2, 3*x+1) for x in 1..6}",
            "expected": [
                4,
                1,
                10,
                2,
                16,
                3
            ],
            "expectedType": "NodeVector",
            "notes": "Collatz step in comprehension"
        }
    ]
}
